<!DOCTYPE HTML>
<html>

<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.1/css/bulma.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.32.0/codemirror.min.css" />

    <link rel="stylesheet" href="styles.css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.32.0/codemirror.min.js"></script>
</head>

<body>
    <section class="section" style="height:100%">
        <div class="container" id="main-container">
            <h1 class="title">Section</h1>
            <h2 class="subtitle">
                A simple container to divide your page into
                <strong>sections</strong>, like the one you're currently reading
            </h2>
            <table>
                <tbody id="log-tbody">

                </tbody>
            </table>
        </div>
    </section>
    <script type="text/javascript">
        var editor = CodeMirror(document.getElementById("main-container"), {
            value: "",
            height: "auto",
            viewportMargin: Infinity,
            lineWrapping: true,
            readOnly: true
        });
        function myWebsocketStart() {
            var ws = new WebSocket("ws://localhost:3000/ws");

            ws.onmessage = function (evt) {
                // var myTextArea = document.getElementById("textarea1");
                // myTextArea.value = myTextArea.value + "\n" + evt.data
                // appendRow(evt.data)
                editor.replaceRange(evt.data, {line: Infinity});
                editor.execCommand("goDocEnd");
            };

            ws.onclose = function () {
                // var myTextArea = document.getElementById("textarea1");
                // myTextArea.value = myTextArea.value + "\n" + "Connection closed";
            };

        }

        function appendRow(value) {
            var td = document.createElement("td");
            var tr = document.createElement("tr");
            tr.appendChild(td)
            td.textContent = value;
            document.getElementById("log-tbody").appendChild(tr)

        }


        myWebsocketStart()

    </script>
</body>

</html>